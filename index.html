<!DOCTYPE html>
<html lang="si">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anu's English School - Days & Months Challenge</title>
    <style>
        :root { 
            --primary: #2980b9; 
            --secondary: #27ae60; 
            --admin: #c0392b; 
            --bg-gradient: linear-gradient(-45deg, #ee7752, #e73c7e, #23a6d5, #23d5ab);
        }

        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            display: flex; 
            flex-direction: column;
            align-items: center; 
            min-height: 100vh; 
            margin: 0; 
            padding: 15px;
            box-sizing: border-box;
            color: #333;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .container { 
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(10px);
            width: 100%; 
            max-width: 500px; 
            padding: 25px; 
            border-radius: 24px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.2); 
            text-align: center; 
            box-sizing: border-box;
            margin-bottom: 20px;
            border: 1px solid rgba(255,255,255,0.3);
        }

        .chat-wrapper {
            width: 100%;
            max-width: 500px;
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            background: white;
            margin-bottom: 20px;
        }

        iframe { width: 100%; border: none; display: block; }

        .tab-buttons { display: flex; justify-content: center; margin-bottom: 25px; gap: 10px; }
        .tab-btn { flex: 1; padding: 12px; border: none; background: #e0e0e0; cursor: pointer; border-radius: 12px; font-weight: bold; transition: 0.3s; }
        .tab-btn.active { background: var(--primary); color: white; box-shadow: 0 4px 10px rgba(41, 128, 185, 0.3); }

        input { box-sizing: border-box; padding: 15px; width: 100%; margin: 10px 0; border: 2px solid #eee; border-radius: 12px; font-size: 16px; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--primary); }

        button.action-btn { padding: 16px; background: var(--secondary); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 16px; font-weight: bold; width: 100%; margin-top: 15px; transition: 0.3s; box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3); }
        button.action-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(39, 174, 96, 0.4); }

        .hidden { display: none; }
        #timer { font-size: 28px; color: #d35400; font-weight: 800; margin: 15px 0; font-family: 'Courier New', Courier, monospace; }
        
        #word-display { 
            font-size: 32px; margin: 20px 0; color: var(--primary); font-weight: bold; 
            background: #f8f9fa; border: 2px dashed #cbd5e0; padding: 30px 10px; 
            border-radius: 18px; min-height: 120px; display: flex; flex-direction: column; 
            align-items: center; justify-content: center;
        }

        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .opt-btn { background: white; border: 2px solid #edf2f7; padding: 15px; font-size: 17px; border-radius: 15px; cursor: pointer; font-weight: 600; transition: 0.2s; }
        .opt-btn:hover { background: #f1f5f9; border-color: var(--primary); }

        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border-bottom: 1px solid #eee; padding: 12px 8px; font-size: 12px; text-align: center; }
        
        #stats-panel { display: flex; justify-content: space-around; background: #f1f5f9; padding: 12px; border-radius: 12px; margin-bottom: 15px; font-weight: bold; font-size: 14px; }
        #feedback { font-size: 18px; font-weight: bold; height: 35px; margin-bottom: 10px; }
        .good { color: #27ae60; } .bad { color: #c0392b; }

        #custom-alert { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; justify-content: center; align-items: center; z-index: 1000; visibility: hidden; }
        .alert-content { background: white; padding: 30px; border-radius: 20px; width: 85%; max-width: 320px; text-align: center; box-shadow: 0 20px 40px rgba(0,0,0,0.4); }

        .leaderboard-wrapper { max-height: 300px; overflow-y: auto; border: 1px solid #edf2f7; border-radius: 12px; margin-top: 10px; background: white; }
    </style>
</head>
<body onload="initializeData()">

<div id="custom-alert">
    <div class="alert-content">
        <h3 style="margin-top:0; color:#c0392b;">‡∂±‡∑í‡∑Ä‡∑ö‡∂Ø‡∂±‡∂∫‡∂∫‡∑í</h3>
        <p id="alert-msg" style="font-weight:bold; line-height:1.5;"></p>
        <button class="action-btn" style="width:100%; padding:12px; background:var(--primary);" onclick="closeAlert()">‡∂≠‡∑ö‡∂ª‡∑î‡∂´‡∑è (OK)</button>
    </div>
</div>

<div class="container">
    <div id="home-screen">
        <h1 style="color: #2c3e50; font-size: 26px; margin-bottom:5px;">üè´ Anu's English School</h1>
        <p style="margin-top:0; color:#7f8c8d; font-weight:600;">Days & Months Master Challenge</p>
        
        <div class="tab-buttons">
            <button class="tab-btn active" id="player-tab" onclick="switchTab('player')">‡∑Å‡∑í‡∑Ç‡∑ä‚Äç‡∂∫‡∂∫‡∑è</button>
            <button class="tab-btn" id="admin-tab" onclick="switchTab('admin')">‡∂¥‡∂ª‡∑í‡∂¥‡∑è‡∂Ω‡∂ö</button>
        </div>

        <div id="player-form">
            <div style="background: #fff9db; padding: 15px; border-radius: 15px; text-align: left; margin-bottom: 20px; border-left: 5px solid #fcc419; font-size: 12px;">
                <b>üìù ‡∑Ä‡∑í‡∂∑‡∑è‡∂ú ‡∂±‡∑ì‡∂≠‡∑í ‡∂ª‡∑ì‡∂≠‡∑í:</b>
                <ul style="margin: 8px 0; padding-left: 18px; line-height:1.6;">
                    <li>‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂± 100 ‡∂ö‡∑ä ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂ö‡∑è‡∂Ω‡∂∫ ‡∑Ä‡∑í‡∂±‡∑è‡∂©‡∑í 15 ‡∂ö‡∑í.</li>
                    <li>‡∂ë‡∂ö‡∑ä ‡∂Ö‡∂∫‡∑ô‡∂ö‡∑î‡∂ß ‡∂Ö‡∑Ä‡∑É‡∑ä‡∂Æ‡∑è‡∑Ä ‡∑Ñ‡∑í‡∂∏‡∑í‡∑Ä‡∂±‡∑ä‡∂±‡∑ö <b>‡∂ë‡∂ö‡∑ä ‡∑Ä‡∂ª‡∂ö‡∑ä</b> ‡∂¥‡∂∏‡∂´‡∑í.</li>
                    <li>‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫ ‡∂Ö‡∂≠‡∂ª‡∂≠‡∑î‡∂ª ‡∂¥‡∑í‡∂ß‡∑Ä‡∑ì‡∂∏ ‡∑Ñ‡∑ù refresh ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∂ö‡∑Ö‡∑Ñ‡∑ú‡∂≠‡∑ä ‡∂î‡∂∂‡∑Ä block ‡∑Ä‡∂±‡∑î ‡∂á‡∂≠.</li>
                </ul>
            </div>
            <input type="text" id="user-name" placeholder="‡∂î‡∂∂‡∑ö ‡∂±‡∂∏ (Full Name)">
            <input type="tel" id="user-phone" placeholder="‡∂Ø‡∑î‡∂ª‡∂ö‡∂Æ‡∂± ‡∂Ö‡∂Ç‡∂ö‡∂∫ (Phone Number)">
            <button class="action-btn" onclick="strictLogin()">‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫ ‡∂Ö‡∂ª‡∂π‡∂±‡∑ä‡∂±</button>
        </div>

        <div id="admin-panel" class="hidden">
            <input type="password" id="admin-pass" placeholder="‡∂¥‡∂ª‡∑í‡∂¥‡∑è‡∂Ω‡∂ö ‡∂∏‡∑î‡∂ª‡∂¥‡∂Ø‡∂∫">
            <button class="action-btn" style="background: var(--admin);" onclick="verifyAdmin()">Dashboard ‡∂ë‡∂ö‡∂ß ‡∂∫‡∂±‡∑ä‡∂±</button>
        </div>

        <div id="public-leaderboard" style="margin-top: 25px;">
            <h3 style="font-size:18px;">üèÜ ‡∂¥‡∑ä‚Äç‡∂ª‡∂∏‡∑î‡∂õ‡∑É‡∑ä‡∂Æ‡∑è‡∂± (Leaderboard)</h3>
            <div class="leaderboard-wrapper">
                <table>
                    <thead><tr style="background:#f8f9fa;"><th>‡∑É‡∑ä‡∂Æ‡∑è‡∂±‡∂∫</th><th>‡∂±‡∂∏</th><th>‡∂Ω‡∂ö‡∑î‡∂´‡∑î</th><th>‡∂Ø‡∑í‡∂±‡∂∫ / ‡∑Ä‡∑ö‡∂Ω‡∑è‡∑Ä</th></tr></thead>
                    <tbody id="public-score-list"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="game-screen" class="hidden">
        <div id="timer">‚è≥ 15:00</div>
        <div id="stats-panel">
            <span id="score-display">Score: 0/100</span>
            <span id="attempt-display">Q: 1/100</span>
        </div>
        <div id="feedback"></div>
        <div id="word-display"></div>
        <div class="options" id="options-container"></div>
    </div>

    <div id="congrats-screen" class="hidden">
        <div style="font-size: 50px;">üéä</div>
        <h1 style="color: #27ae60; margin-top:0;">‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫ ‡∂Ö‡∑Ä‡∑É‡∂±‡∑ä!</h1>
        <p id="final-msg" style="font-size: 19px; font-weight: bold; background:#f1f5f9; padding:20px; border-radius:15px;"></p>
        <button class="action-btn" onclick="location.reload()">‡∂∏‡∑î‡∂Ω‡∂ß ‡∂∫‡∂±‡∑ä‡∂±</button>
    </div>
</div>

<script>
    const API_URL = "https://script.google.com/macros/s/AKfycbyQra2fdYX6U1M0rXbu8mbCHmIYNGui3koOcj_UKMwLQNfL1QmURZjgs7iCYU1uiwJR/exec"; 
    const ADMIN_SECRET = "51001992";
    
    // ‡∂∏‡∑ì‡∂ß ‡∂¥‡∑ô‡∂ª ‡∂≠‡∑í‡∂∂‡∑ñ allowedNumbers ‡∑É‡∑ì‡∂∏‡∑è‡∑Ä ‡∂â‡∑Ä‡∂≠‡∑ä ‡∂ö‡∂ª‡∂± ‡∂Ω‡∂Ø‡∑í. ‡∂Ø‡∑ê‡∂±‡∑ä ‡∂ï‡∂±‡∑ë‡∂∏ ‡∂ö‡∑ô‡∂±‡∑ô‡∂ö‡∑î‡∂ß ‡∂Ω‡∑ú‡∂ú‡∑ä ‡∑Ä‡∑í‡∂∫ ‡∑Ñ‡∑ê‡∂ö.

    const DAYS = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
    const MONTHS = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
    
    const VOCAB = [
        {e: "Monday", s: "‡∑É‡∂≥‡∑î‡∂Ø‡∑è"}, {e: "Tuesday", s: "‡∂Ö‡∂ü‡∑Ñ‡∂ª‡∑î‡∑Ä‡∑è‡∂Ø‡∑è"}, {e: "Wednesday", s: "‡∂∂‡∂Ø‡∑è‡∂Ø‡∑è"},
        {e: "Thursday", s: "‡∂∂‡∑ä‚Äç‡∂ª‡∑Ñ‡∑É‡∑ä‡∂¥‡∂≠‡∑í‡∂±‡∑ä‡∂Ø‡∑è"}, {e: "Friday", s: "‡∑É‡∑í‡∂ö‡∑î‡∂ª‡∑è‡∂Ø‡∑è"}, {e: "Saturday", s: "‡∑É‡∑ô‡∂±‡∑É‡∑î‡∂ª‡∑è‡∂Ø‡∑è"},
        {e: "Sunday", s: "‡∂â‡∂ª‡∑í‡∂Ø‡∑è"}, {e: "January", s: "‡∂¢‡∂±‡∑Ä‡∑è‡∂ª‡∑í"}, {e: "February", s: "‡∂¥‡∑ô‡∂∂‡∂ª‡∑Ä‡∑è‡∂ª‡∑í"},
        {e: "March", s: "‡∂∏‡∑è‡∂ª‡∑ä‡∂≠‡∑î"}, {e: "April", s: "‡∂Ö‡∂¥‡∑ä‚Äç‡∂ª‡∑ö‡∂Ω‡∑ä"}, {e: "May", s: "‡∂∏‡∑ê‡∂∫‡∑í"},
        {e: "June", s: "‡∂¢‡∑ñ‡∂±‡∑í"}, {e: "July", s: "‡∂¢‡∑ñ‡∂Ω‡∑í"}, {e: "August", s: "‡∂Ö‡∂ú‡∑ù‡∑É‡∑ä‡∂≠‡∑î"},
        {e: "September", s: "‡∑É‡∑ê‡∂¥‡∑ä‡∂≠‡∑ê‡∂∏‡∑ä‡∂∂‡∂ª‡∑ä"}, {e: "October", s: "‡∂î‡∂ö‡∑ä‡∂≠‡∑ù‡∂∂‡∂ª‡∑ä"}, {e: "November", s: "‡∂±‡∑ú‡∑Ä‡∑ê‡∂∏‡∑ä‡∂∂‡∂ª‡∑ä"},
        {e: "December", s: "‡∂Ø‡∑ô‡∑É‡∑ê‡∂∏‡∑ä‡∂∂‡∂ª‡∑ä"}
    ];

    let score = 0, idx = 0, time = 900, timer, uName, uPhone, currentCorrect;
    let serverScores = [];

    function myAlert(msg) { document.getElementById('alert-msg').innerText = msg; document.getElementById('custom-alert').style.visibility = 'visible'; }
    function closeAlert() { document.getElementById('custom-alert').style.visibility = 'hidden'; }

    function switchTab(t) { 
        document.getElementById('player-form').classList.toggle('hidden', t==='admin');
        document.getElementById('admin-panel').classList.toggle('hidden', t==='player');
        document.getElementById('public-leaderboard').classList.toggle('hidden', t==='admin');
        document.getElementById('player-tab').classList.toggle('active', t==='player');
        document.getElementById('admin-tab').classList.toggle('active', t==='admin');
    }

    async function initializeData() {
        if(localStorage.getItem('anu_exam_status') === 'blocked') {
            document.getElementById('player-form').innerHTML = "<h3 style='color:red;'>‡∑É‡∂∏‡∑è‡∑Ä‡∂±‡∑ä‡∂±! ‡∂î‡∂∂ ‡∂Ø‡∑ê‡∂±‡∂ß‡∂∏‡∂≠‡∑ä ‡∂∏‡∑ô‡∂∏ ‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫‡∂ß ‡∑É‡∑Ñ‡∂∑‡∑è‡∂ú‡∑ì ‡∑Ä‡∑ì ‡∂á‡∂≠.</h3>";
        }

        try {
            const r = await fetch(API_URL);
            const data = await r.json();
            serverScores = data.scores || [];
            renderLeaderboard(serverScores);
        } catch(e) { console.log("Leaderboard loading error."); }
    }

    async function strictLogin() {
        // ‡∂ö‡∑è‡∂Ω‡∂∫ ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è‡∑Ä
        const startTime = new Date("2026-02-09T19:00:00");
        const now = new Date();
        if (now < startTime) {
            return myAlert("‡∂∏‡∑ô‡∂∏ ‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫ ‡∂Ü‡∂ª‡∂∏‡∑ä‡∂∑ ‡∑Ä‡∂±‡∑ä‡∂±‡∑ö 02/09 ‡∂ª‡∑è‡∂≠‡∑ä‚Äç‡∂ª‡∑ì 7.00 ‡∂ß ‡∂∫.");
        }

        uName = document.getElementById('user-name').value.trim();
        uPhone = document.getElementById('user-phone').value.trim();
        
        if(!uName || !uPhone) return myAlert("‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∂ö‡∂ª ‡∂±‡∂∏ ‡∑É‡∑Ñ ‡∂Ö‡∂Ç‡∂ö‡∂∫ ‡∂á‡∂≠‡∑î‡∑Ö‡∂≠‡∑ä ‡∂ö‡∂ª‡∂±‡∑ä‡∂±.");
        
        // ‡∂ö‡∂Ω‡∑í‡∂±‡∑ä ‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫ ‡∂ö‡∂ª ‡∂á‡∂≠‡∑í‡∂Ø‡∑ê‡∂∫‡∑í ‡∂¥‡∂ª‡∑ì‡∂ö‡∑ä‡∑Ç‡∑è ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ (Database ‡∂ë‡∂ö‡∑ö Phone number ‡∂ë‡∂ö ‡∂≠‡∑í‡∂∂‡∑ö‡∂Ø‡∑ê‡∂∫‡∑í ‡∂∂‡∂Ω‡∂∫‡∑í)
        const alreadyDone = serverScores.some(s => String(s.phone).trim() === uPhone);
        if(alreadyDone || localStorage.getItem('anu_exam_status') === 'blocked') {
            localStorage.setItem('anu_exam_status', 'blocked');
            return myAlert("‡∑É‡∂∏‡∑è‡∑Ä‡∂±‡∑ä‡∂±, ‡∂∏‡∑ô‡∂∏ ‡∂Ø‡∑î‡∂ª‡∂ö‡∂Æ‡∂± ‡∂Ö‡∂Ç‡∂ö‡∂∫ ‡∂∏‡∂ú‡∑í‡∂±‡∑ä ‡∂Ø‡∑ê‡∂±‡∂ß‡∂∏‡∂≠‡∑ä ‡∑Ä‡∑í‡∂∑‡∑è‡∂ú‡∂∫ ‡∂Ö‡∑Ä‡∑É‡∂±‡∑ä ‡∂ö‡∂ª ‡∂á‡∂≠.");
        }

        // ‡∑Ä‡∑Ñ‡∑è‡∂∏ block ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ (Refresh ‡∑Ä‡∑ê‡∑Ö‡∑ê‡∂ö‡∑ä‡∑Ä‡∑ì‡∂∏‡∂ß)
        localStorage.setItem('anu_exam_status', 'blocked');

        document.getElementById('home-screen').classList.add('hidden');
        document.getElementById('game-screen').classList.remove('hidden');
        startGame();
    }

    function startGame() {
        timer = setInterval(() => {
            time--;
            let m=Math.floor(time/60), s=time%60;
            document.getElementById('timer').innerText = `‚è≥ ${m}:${s<10?'0':''}${s}`;
            if(time<=0) endGame();
        }, 1000);
        next();
    }

    function next() {
        if(idx >= 100) return endGame();
        const container = document.getElementById('options-container');
        const display = document.getElementById('word-display');
        document.getElementById('feedback').innerText = ""; container.innerHTML = ""; 

        if(idx < 30) {
            let obj = VOCAB[Math.floor(Math.random() * VOCAB.length)];
            let word = obj.e.toUpperCase();
            let randIdx = Math.floor(Math.random() * (word.length - 1)) + 1;
            currentCorrect = word[randIdx];
            let masked = word.split(""); masked[randIdx] = "_";
            display.innerHTML = `<div style='letter-spacing:10px;'>${masked.join("")}</div><div style='font-size:16px; color:#7f8c8d; margin-top:10px;'>(${obj.s})</div>`;
            let opts = shuffle([currentCorrect, ...shuffle("ABCDEFGHIJKLMNOPQRSTUVWXYZ".replace(currentCorrect,"").split("")).slice(0,3)]);
            opts.forEach(o => container.appendChild(createBtn(o, () => check(o === currentCorrect))));
        } else {
            let q = generateLogicQuestion();
            display.innerHTML = `<div style='font-size:22px;'>${q.question}</div>`;
            currentCorrect = q.answer;
            let opts = shuffle([q.answer, ...q.wrong]);
            opts.forEach(o => container.appendChild(createBtn(o, () => check(o === currentCorrect))));
        }
    }

    function generateLogicQuestion() {
        let type = Math.floor(Math.random() * 5);
        let list = Math.random() > 0.5 ? DAYS : MONTHS;
        if (type === 0) {
            let rIdx = Math.floor(Math.random() * (list.length - 1));
            return { question: `What comes <b>AFTER</b> ${list[rIdx]}?`, answer: list[rIdx + 1], wrong: shuffle(list.filter(i => i !== list[rIdx+1])).slice(0, 3) };
        } else if (type === 1) {
            let rIdx = Math.floor(Math.random() * (list.length - 1)) + 1;
            return { question: `What comes <b>BEFORE</b> ${list[rIdx]}?`, answer: list[rIdx - 1], wrong: shuffle(list.filter(i => i !== list[rIdx-1])).slice(0, 3) };
        } else if (type === 2) {
            let isFirst = Math.random() > 0.5;
            let ans = isFirst ? (list === DAYS ? "Monday" : "January") : (list === DAYS ? "Sunday" : "December");
            let q = `The <b>${isFirst ? 'FIRST' : 'LAST'}</b> ${list === DAYS ? 'day of the week' : 'month of the year'} is?`;
            return { question: q, answer: ans, wrong: shuffle(list.filter(i => i !== ans)).slice(0, 3) };
        } else if (type === 3) {
            let rIdx = Math.floor(Math.random() * (list.length - 2));
            return { question: `What is <b>BETWEEN</b> ${list[rIdx]} and ${list[rIdx+2]}?`, answer: list[rIdx+1], wrong: shuffle(list.filter(i => i !== list[rIdx+1])).slice(0, 3) };
        } else {
            return { question: "The <b>MIDDLE</b> day of the week is?", answer: "Thursday", wrong: ["Monday", "Saturday", "Sunday"] };
        }
    }

    function createBtn(t, fn) { const b = document.createElement('button'); b.className="opt-btn"; b.innerText=t; b.onclick=fn; return b; }
    
    function check(isCorrect) {
        if(isCorrect) { score++; document.getElementById('feedback').innerHTML = "<span class='good'>‚úÖ Correct!</span>"; }
        else { document.getElementById('feedback').innerHTML = "<span class='bad'>‚ùå Wrong!</span>"; }
        document.getElementById('score-display').innerText = `Score: ${score}/100`;
        document.getElementById('attempt-display').innerText = `Q: ${idx+1}/100`;
        idx++; setTimeout(next, 350);
    }

    function shuffle(a) { return [...a].sort(() => Math.random() - 0.5); }

    async function endGame() {
        clearInterval(timer);
        document.getElementById('game-screen').innerHTML = "<h2>‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∑É‡∑î‡∂ª‡∑ê‡∂ö‡∑ô‡∂∏‡∑í‡∂±‡∑ä ‡∂¥‡∑Ä‡∂≠‡∑ì...</h2>";
        const dateStr = new Date().toLocaleString('en-GB', { day:'2-digit', month:'2-digit', hour:'2-digit', minute:'2-digit', second:'2-digit' });
        try {
            await fetch(API_URL, { 
                method: 'POST', 
                mode: 'no-cors',
                body: JSON.stringify({ action: "saveScore", data: { name: uName, phone: uPhone, score: score, date: dateStr } }) 
            });
            document.getElementById('game-screen').classList.add('hidden');
            document.getElementById('congrats-screen').classList.remove('hidden');
            document.getElementById('final-msg').innerText = `${uName},\n‡∂î‡∂∂‡∑ö ‡∂Ω‡∂ö‡∑î‡∂´‡∑î ‡∑É‡∂Ç‡∂õ‡∑ä‚Äç‡∂∫‡∑è‡∑Ä: ${score}/100`;
        } catch(e) { location.reload(); }
    }

    function renderLeaderboard(data) {
        data.sort((a,b) => (b.score - a.score));
        document.getElementById('public-score-list').innerHTML = data.slice(0, 20).map((s, index) => {
            let medal = index === 0 ? "ü•á" : (index === 1 ? "ü•à" : (index === 2 ? "ü•â" : index + 1));
            return `<tr>
                <td><b>${medal}</b></td>
                <td style="text-align:left;">${s.name}</td>
                <td style="color:var(--primary); font-weight:bold;">${s.score}</td>
                <td style="font-size:10px; color:gray;">${s.date}</td>
            </tr>`;
        }).join("");
    }
</script>
</body>
</html>
